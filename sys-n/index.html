<!DOCTYPE html>
<html>

<head>
  <title>Solar System based on Three.JS</title>
  <meta charset="utf8">
  <link rel="icon" href="/nineplanets-org/neptune-150x150.png" type="image/png">
  <link rel="stylesheet" type="text/css" href="/style.css">
  <style>
    body {
      background-color: black;
      /* background-image: url(/nasa3d/tycho8.jpg); */
      background-repeat: no-repeat;
    }
  </style>
</head>

<body>
  <script src="/runtime.js"></script>
  <script type="module" src="/sys-n/app.ts"></script>
  <script>
    const __COMPUTION_RESULT_CALLBACKS__ = []
    function computionResultJsonp(callback) {
      __COMPUTION_RESULT_CALLBACKS__.push(callback)
    }
    const es = new EventSource("/sse-open")
    es.onmessage = (evt) => {
      const data = JSON.parse(evt.data)
      if (data.reload) {
        console.log('sse reload')
        location.reload()
        return
      }
      const payload = JSON.parse(data.data)
      if (payload.buffer) {
        phases['buffer']()
        console.log('sse buffer')
      } else if (payload.init) {
        phases['init']()
        console.log('sse init')
      } else {
        for (const callback of __COMPUTION_RESULT_CALLBACKS__) {
          callback(payload)
        }
      }
    }
  </script>
</body>

</html>